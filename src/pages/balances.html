<div class="row">
  <div class="col-xs-12 col-sm-7 col-md-7 col-lg-4">
    <h1 class="page-title txt-color-blueDark">
      <i class="fa fa-user fa-fw "></i> 
        My Account Balances 
    </h1>
  </div>
  <div class="pull-right">
      <button id="createNewAddress" type="button" class="btn btn-primary">Create New Address</button>
  </div>
</div>

<div id="balances">
  <section id="widget-grid" class=""> <!-- widget grid -->
    <div id="balancesContainer" data-bind="foreach: addresses" class="row"> <!-- one row per widget in this case -->
      <article class="col-xs-12 col-sm-12 col-md-12 col-lg-12"> <!-- widget START -->
        <div class="jarviswidget" data-bind="attr: {'id': 'address-wid-' + $data.ADDRESS}" data-widget-deletebutton="false" data-widget-editbutton="false">
          <header>
            <span class="widget-icon"> <i class="fa fa-bars"></i> </span>
            <h2 class="jarviswidget-ctrls"><a href="#" data-bind="editable: label, editableOptions: { type: 'text', url: changeLabel, placement: 'bottom', title: 'Enter a new nickname for this address' }" style="text-decoration:underline"></a></h2>
            <div class="widget-toolbar">
              <div class="btn-group">
                <button class="btn dropdown-toggle btn-xs btn-primary" data-toggle="dropdown"><i class="fa fa-bars"></i> Address Actions <i class="fa fa-caret-down"></i></button>                
                <ul class="dropdown-menu pull-right">
                  <li><a data-bind="click: showQRCode" href="#">Show QR Code</a></li>
                  <li><a data-bind="click: createAssetIn" href="#">Create Asset</a></li>
                  <li class="divider"></li><li class="dropdown-header">Sort by...</li>
                    <li><a data-bind="click: sortAssetsByName" href="#">Name</a></li>
                    <li><a data-bind="click: sortAssetsByBalance" href="#">Balance</a></li>
                  <li class="divider"></li><li class="dropdown-header">Filter by...</li>
                    <li><a data-bind="click: showAllAssets" href="#">Show All</a></li>
                    <li><a data-bind="click: showBaseAssetsOnly" href="#">Show XCP &amp; BTC Only</a></li>
                    <li><a data-bind="click: showMyAssetsOnly" href="#">Show My Assets Only</a></li>
                    <li><a data-bind="click: showOthersAssetsOnly" href="#">Show Others' Assets Only</a></li>
                </ul>
              </div>
            </div>
            <div class="widget-toolbar"><span id="" data-bind="attr: {'id': 'address-text-' + $data.ADDRESS}, click: function(data, event) { return selectText('address-text-' + $data.ADDRESS); }, text: ADDRESS"></span></div>  
          </header>
          <div> <!-- widget div-->
            <div class="widget-body" data-bind="attr: {'id': 'address-balances-' + $data.ADDRESS}, foreach: filteredAssets"> <!-- widget content -->
              <div class="asset-item" data-bind="css: { btc: ASSET == 'BTC', xcp: ASSET == 'XCP', myasset: isMine(), othersasset: isMine() == false }">
                <div class="btn-group" style="display: inline-block; float: right; width: 30px; height: 32px; line-height: 32px; position: relative; margin-left: 10px; "> <!-- asset level action button -->
                  <button type="button" class="btn btn-default dropdown-toggle" data-toggle="dropdown"><span class="caret"></span></button>
                  <ul class="dropdown-menu" role="menu">
                    <li><a data-bind="click: send" href="#">Send</a></li>
                    <li data-bind="visible: isMine() && !isLocked()"><a data-bind="click: issueAdditional" href="#">Issue Additional</a></li>
                    <li data-bind="visible: isMine()"><a data-bind="click: transfer" href="#">Transfer Ownership</a></li>
                    <li data-bind="visible: isMine() && !isLocked()"><a data-bind="click: lock" href="#">Lock Asset Ownership</a></li>
                    <li data-bind="visible: isMine()"><a data-bind="click: changeDescription" href="#">Change Asset Description</a></li>
                  </ul>
                </div>
                <h3 class="name pull-left" style="position: relative; top: -10px;" data-bind="text: ASSET"></h3>
                <div class="clearfix"></div>
                <p class="balance" data-bind="text: displayedBalance"></p>
              </div>
            </div> <!-- end widget content body -->
          </div> <!-- end widget div -->
        </div> <!-- end widget -->
      </article> <!-- WIDGET END -->
    </div> <!-- balances container, foreach: address -->
  </section> <!-- end widget grid -->
</div>
  
<!-- modal for create asset -->
<div data-bind="showModal: shown", id="createAssetModal" class="modal fade" data-backdrop="static" data-keyboard="false" tabindex="-1" role="dialog" aria-labelledby="createAssetModal" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" data-bind="click: hide" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
        <h4 class="modal-title">Create (Issue) an Asset</h4>
      </div>
      <div class="modal-body no-padding">
        <p>Please note that a <b>5 XCP fee</b> will be deducted from your balance upon successful creation of an asset.</p>
        
        <form class="smart-form" data-bind="submit: createAsset"><fieldset>
          <section><div class="row">
            <label class="label col col-2">For Address</label>
            <div class="col col-10">
                <label class="input"><i class="icon-append fa fa-user"></i>
                    <input name="assetAddress" data-bind="value: address" type="text" readonly="readonly"/>
                </label>
                <div class="note">The address the asset will be created on.</div>
            </div>
          </div></section>
          <section><div class="row">
            <label class="label col col-2">Asset Name</label>
            <div class="col col-10">
                <label class="input">
                    <input name="assetName" data-bind="value: name" type="text"/>
                </label>
                <div class="note">The asset's trading symbol (also known as the Asset ID).</div>
            </div>
          </div></section>
          <section><div class="row">
            <label class="label col col-2">Description</label>
            <div class="col col-10">
                <label class="input">
                    <input name="assetDescription" data-bind="value: description"/>
                </label>
                <div class="note">Optional text that provides more information on the asset.</div>
            </div>
          </div></section>
          <section><div class="row">
            <label class="label col col-2">Quantity</label>
            <div class="col col-10">
                <label class="input">
                    <input name="assetQuantity"  data-bind="value: quantity" type="text"/>                        
                </label>
                <div class="note">How many of the units of the asset to issue (can be increased later).</div>
            </div>
          </div></section>
          <section><div class="row">
            <div class="col col-2"></div>
            <div class="col col-10">
              <label class="checkbox">
                <input name="assetDivisible" type="checkbox" data-bind="checked: divisible">
                <i></i>Divisible asset?
              </label>
              <div class="note">Divisble assets can be subdivided into decimal places.</div>
          </div></section>
          <section><div class="row">
            <div class="col col-2"></div>
            <div class="col col-10">
              <label class="checkbox">
                <input name="assetCallable" type="checkbox" data-bind="checked: callable">
                <i></i>Callable asset?
              </label>
              <div class="note">Callable assets may be called back at a specific date for a specific strike price.</div>
          </div></section>
          <section data-bind="visible: callable"><div class="row">                
            <label class="label col col-2">Call Date</label>
            <div class="col col-10">
                <label class="input">
                    <input name="assetCallDate" type="text" data-bind="datetimepicker:callDate"/>
                </label>
                <div class="note">The date and time after which the owner of the asset may choose to call it back.</div>
            </div>
          </div></section>
          <section data-bind="visible: callable"><div class="row">                
            <label class="label col col-2">Call Price</label>
            <div class="col col-10">
                <label class="input">
                    <input name="assetQuantity" type="text" data-bind="value: callPrice"/>
                </label>
                <div class="note">The price that the owner of the asset may call it back for.</div>
            </div>
          </div></section>
        </fieldset></form>                    
      </div>
      <div class="modal-footer">
        <button type="button" data-bind="click: submitForm" class="btn btn-primary">Create Asset</button>
        <button type="button" class="btn btn-default" data-bind="click: hide">Cancel</button>
      </div>
    </div><!-- /.modal-content -->
  </div><!-- /.modal-dialog -->
</div><!-- /.modal -->

<script src="xcp/js/components/create_asset.js"></script>
<script src="xcp/js/components/balances.js"></script>

<script type="text/javascript">
  //Bind the WALLET object to balancesContainer
  $(document).ready(function() {
    $.jqlog.enabled(true);
    ko.applyBindings(WALLET, document.getElementById("balancesContainer"));
    WALLET.updateBalances(); //Update the wallet balances
  });

  pageSetUp(); //init smartadmin featureset
</script>
