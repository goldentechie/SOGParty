<div class="row">
  <div class="col-xs-12 col-sm-7 col-md-7 col-lg-4">
    <h1 class="page-title txt-color-blueDark">
      <i class="fa fa-btc fa-fw "></i> 
        My Account Balances 
    </h1>
  </div>
</div>

<div id="balances">
  <section id="widget-grid" class=""> <!-- widget grid -->
    <div id="balancesContainer" data-bind="foreach: addresses" class="row"> <!-- one row per widget in this case -->
      <article class="col-xs-12 col-sm-12 col-md-12 col-lg-12"> <!-- widget START -->
        <div class="jarviswidget" data-bind="attr: {'id': 'address-wid-' + $data.ADDRESS}" data-widget-deletebutton="false" data-widget-editbutton="false">
          <header>
            <span class="widget-icon"> <i class="fa fa-bars"></i> </span>
            <h2 class="jarviswidget-ctrls"><a href="#" data-bind="editable: label, editableOptions: { type: 'text', url: changeLabel, placement: 'bottom', title: 'Enter a new nickname for this address' }" style="text-decoration:underline"></a></h2>
            <div class="widget-toolbar">
              <div class="btn-group">
                <button class="btn dropdown-toggle btn-xs btn-primary" data-toggle="dropdown"><i class="fa fa-bars"></i> Address Actions <i class="fa fa-caret-down"></i></button>                
                <ul class="dropdown-menu pull-right">
                  <li><a data-bind="click: sendFrom" href="#">Send From</a></li>
                  <li><a data-bind="click: showQRCode" href="#">Show QR Code</a></li>
                  <li><a data-bind="click: createAssetIn" href="#">Create Asset</a></li>
                  <li class="divider"></li><li class="dropdown-header">Sort by...</li>
                    <li><a data-bind="click: sortAssetsByName" href="#">Name</a></li>
                    <li><a data-bind="click: sortAssetsByBalance" href="#">Balance</a></li>
                  <li class="divider"></li><li class="dropdown-header">Filter by...</li>
                    <li><a data-bind="click: showAllAssets" href="#">Show All</a></li>
                    <li><a data-bind="click: showBaseAssetsOnly" href="#">Show XCP &amp; BTC Only</a></li>
                    <li><a data-bind="click: showMyAssetsOnly" href="#">Show My Assets Only</a></li>
                    <li><a data-bind="click: showOthersAssetsOnly" href="#">Show Others' Assets Only</a></li>
                </ul>
              </div>
            </div>
            <div class="widget-toolbar"><span id="" data-bind="attr: {'id': 'address-text-' + $data.ADDRESS}, click: function(data, event) { return selectText('address-text-' + $data.ADDRESS); }, text: ADDRESS"></span></div>  
          </header>
          <div> <!-- widget div-->
            <div class="widget-body" data-bind="attr: {'id': 'address-balances-' + $data.ADDRESS}, foreach: filteredAssets"> <!-- widget content -->
              <div class="asset-item" data-bind="css: { btc: ASSET == 'BTC', xcp: ASSET == 'XCP', myasset: isMine(), othersasset: isMine() == false }">
                <div class="btn-group" style="display: inline-block; float: right; width: 30px; height: 32px; line-height: 32px; position: relative; margin-left: 10px; "> <!-- asset level action button -->
                  <button type="button" class="btn btn-default dropdown-toggle" data-toggle="dropdown"><span class="caret"></span></button>
                  <ul class="dropdown-menu" role="menu">
                    <li><a data-bind="click: sendTo" href="#">Send to...</a></li>
                    <li data-bind="visible: isMine() && !isLocked()"><a data-bind="click: issueAdditional" href="#">Issue Additional</a></li>
                    <li data-bind="visible: isMine()"><a data-bind="click: transfer" href="#">Transfer Ownership</a></li>
                    <li data-bind="visible: isMine() && !isLocked()"><a data-bind="click: lock" href="#">Lock Asset Ownership</a></li>
                    <li data-bind="visible: isMine()"><a data-bind="click: changeDescription" href="#">Change Asset Description</a></li>
                  </ul>
                </div>
                <h3 class="name pull-left" style="position: relative; top: -10px;" data-bind="text: ASSET"></h3>
                <div class="clearfix"></div>
                <p class="balance" data-bind="text: displayedBalance"></p>
              </div>
            </div> <!-- end widget content body -->
          </div> <!-- end widget div -->
        </div> <!-- end widget -->
      </article> <!-- WIDGET END -->
    </div> <!-- balances container, foreach: address -->
  </section> <!-- end widget grid -->
</div>
  
<!-- modal for send asset -->
<div data-bind="showModal: shown", id="createAssetModal" class="modal fade" data-backdrop="static" data-keyboard="false" tabindex="-1" role="dialog" aria-labelledby="createAssetModal" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" data-bind="click: hide" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
        <h4 class="modal-title">Issue an Asset</h4>
      </div>
      <div class="modal-body">
        <p>Please note that a <b>5 XCP fee</b> will be deducted from your balance upon successful creation of an asset.</p>
        <form role="form" data-bind="submit: createAsset">
          <div class="form-group">
            <label for="assetAddress">Issue on Address</label>
            <input name="assetAddress" data-bind="value: address" type="text" class="form-control" readonly="readonly">
            <p class="help-block">The address the asset will be created on.</p>
          </div>
          <div class="form-group">
            <label for="assetName">Asset Name</label>
            <input name="assetName" data-bind="value: name" type="text" class="form-control"
                   data-validation-regex-regex="[A-Z]+" minlength="4" maxlength="24" data-validation-regex-message="Must be between 4-24 uppercase letters only (A-Z)" required>
            <p class="help-block">The asset's trading symbol (also known as the Asset ID).</p>
          </div>
          <div class="form-group">
            <label for="assetLink">Descriptive Link</label>
            <input name="assetLink" data-bind="value: url" type="url" class="form-control" maxlength="50">
            <p class="help-block">An optional URL that provides more information on the asset.</p>
          </div>
          <div class="form-group">
            <label for="assetQuantity">Quantity to Create</label>
            <input name="assetQuantity"  data-bind="value: quantity" type="text" class="form-control"
                   data-validation-regex-regex="[0-9]*\.?[0-9]{0,8}" data-validation-regex-message="Must be a valid number" required/>                        
            <p class="help-block">How many of the units of the asset to issue (can be increased later).</p>
            <!-- todo, validation currently doesn't differenciate between divisible (FP allowed) and indivisible -->
          <div class="checkbox">
            <label>
              <input name="assetDivisible" type="checkbox" data-bind="checked: divisible"> Divisible asset?
            </label>
            <p class="help-block">Divisble assets can be subdivided into decimal places.</p>
          </div>
          </div>
        </form>                    
      </div>
      <div class="modal-footer">
        <button type="button" data-bind="click: submitForm" class="btn btn-primary">Create Asset</button>
        <button type="button" class="btn btn-default" data-bind="click: hide">Cancel</button>
      </div>
    </div><!-- /.modal-content -->
  </div><!-- /.modal-dialog -->
</div><!-- /.modal -->

<script src="xcp/js/components/create_asset.js"></script>

<script type="text/javascript">
  //Bind the WALLET object to balancesContainer
  $(document).ready(function() {
    $.jqlog.enabled(true);
    ko.applyBindings(WALLET, document.getElementById("balancesContainer"));
    WALLET.updateBalances(); //Update the wallet balances
  });

  pageSetUp(); //init smartadmin featureset
</script>
