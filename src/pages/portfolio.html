<div class="row">
  <div class="col-xs-12 col-sm-7 col-md-7 col-lg-4">
    <h1 class="page-title txt-color-blueDark">
      <i class="fa fa-user fa-fw "></i> 
        Asset Portfolio 
    </h1>
  </div>
</div>

<section id="widget-grid" class="portfolioGrid"> <!-- widget grid -->
  <div class="row"> <!-- row -->
    <article class="col-xs-12 col-sm-12 col-md-12 col-lg-12"> <!-- NEW WIDGET START -->
      <!-- Widget ID (each widget will need unique ID)-->
      <div class="jarviswidget defaultWidgetColor" id="wid-id-portfolioAllocation" data-widget-editbutton="false" data-widget-deletebutton="false">
          <header>
            <span class="widget-icon"> <i class="fa fa-bar-chart-o"></i> </span>
            <h2>Portfolio Allocation</h2>
          </header>
          <div> <!-- widget div-->
            <div class="widget-body no-padding"> <!-- widget content -->
              
              <div class="row">
                  <div class="col-lg-4">
                      <div id="portfolioAssetValsPie"></div>
                  </div>
                  <div class="col-lg-4" data-bind="fadeVisibleInOnly: pctChangesInXCP().length" style="display:none">
                      <div id="pctChangeBarToXCP"></div>
                  </div>
                  <div class="col-lg-4" data-bind="fadeVisibleInOnly: pctChangesInBTC().length" style="display:none">
                    <div id="pctChangeBarToBTC"></div>
                  </div>
            </div> <!-- end widget content -->
          </div> <!-- end widget div -->
      </div> <!-- end widget -->
    </article> <!-- WIDGET END -->
  </div> <!-- end row -->
    
  <div class="row" data-bind="fadeVisibleInOnly: marketCapTableRows().length"> <!-- row -->
    <article class="col-xs-12 col-sm-12 col-md-12 col-lg-12"> <!-- NEW WIDGET START -->
      <div class="jarviswidget defaultWidgetColor" id="wid-id-portfolioComposition" data-widget-editbutton="false" data-widget-deletebutton="false" data-bind="fadeVisibleInOnly: marketCapTableRows().length">
        <header>
            <span class="widget-icon"> <i class="fa fa-table"></i> </span>
            <h2>Portfolio Composition (in <span data-bind="text: showPortfolioIn"></span>)</h2>
            <div class="widget-toolbar">
              <div class="btn-group">
                <button class="btn dropdown-toggle btn-xs btn-primary" data-toggle="dropdown"><i class="fa fa-bars"></i> Show In <i class="fa fa-caret-down"></i></button>                
                <ul class="dropdown-menu pull-right">
                  <li><a data-bind="click: showPortfolioInXCP" href="#">XCP</a></li>
                  <li><a data-bind="click: showPortfolioInBTC" href="#">BTC</a></li>
                </ul>
              </div>
            </div>
        </header>
        <div> <!-- widget div-->
            <div class="widget-body no-padding"> <!-- widget content -->
                <table id="portfolioComposition" class="table table-striped table-hover dt_basic">
                    <thead>
                        <tr>
                            <th>Asset</th>
                            <th>Market Cap</th>
                            <th>Price</th>
                            <th>Total Supply</th>
                            <th>Volume (24h)</th>
                            <th>% Change (24h)</th>
                            <th>Market Cap Graph (7d)</th>
                        </tr>
                    </thead>
                    <tbody data-bind="foreach: marketCapTableRows()">
                        <tr>
                            <td><span style="font-weight: bold; font-size: 1.15em" data-bind="text: asset"></span></td>
                            <td><span data-bind="text: marketCap"></span> <span data-bind="text: $parent.showPortfolioIn()"></span></td>
                            <td><span data-bind="text: price"></span> <span data-bind="text: $parent.showPortfolioIn()"></span></td>
                            <td><span data-bind="text: supply"></span> <span data-bind="text: asset"></span></td>
                            <td><span data-bind="text: volume"></span> <span data-bind="text: $parent.showPortfolioIn()"></span></td>
                            <td><span data-bind="text: pctChange"></span> %</td>
                            <td data-bind="attr: { id: 'miniChart-' + asset }" style="width:180px;height:60px;"></td>
                        </tr>
                    </tbody>
                </table>
            </div> <!-- end widget content -->
        </div> <!-- end widget div -->
      </div> <!-- end widget -->
    </article> <!-- WIDGET END -->
  </div> <!-- end row -->
</section>

<script type="text/javascript">
  pageSetUp(); //init smartadmin featureset
  loadScript("xcp/js/components/portfolio.js", function() {
    //This code is run on each visit to the page
    window.ASSET_PORTFOLIO = new AssetPortfolioViewModel();

    ko.applyBindings(ASSET_PORTFOLIO, document.getElementsByClassName("portfolioGrid")[0]);
    
    ASSET_PORTFOLIO.init();
  
    $(window).bind("resize", ASSET_PORTFOLIO.dataTableResponsive);
    $(window).on('hashchange', function() {
      $(window).off("resize", ASSET_PORTFOLIO.dataTableResponsive);
    });
  });
</script>
